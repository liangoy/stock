## 基于rnn提取股票关键指标
### 文件介绍
1. data中的每个文件都对应一个股票数据，例如bp是标普500，shy是美国国债1-3年ETF，tlt是美国国债20+年ETF，vix是恐慌指数
2. tools中放的是一些脚本，例如dowload_data_from_yahoo就是从雅虎财经上爬去股票数据，用于更新data目录下的数据
3. trains里面是模型的训练代码
### 股票是不是随机漫步
“股票的走势时随机的，无法预测的。”这一观点有很大的市场。
持有这一观点的人认为市场是完全理性的，因此市场的信息一定会极快的反应在股价中。而市场中新的信息的产生又依赖于随机的不可预测的事件（如果事件可以预测，那么他就不会带来新的信息）。
所依股票的价格是随机的无法预测的。
但是事实并非如此.
举一个反例：
用正常的股票历史数据多次去做股票日内振幅的预测模型时，预测振幅与真实振幅的相关性在0.75左右。但是如果讲股票数据按日期打乱，那么其相关性则相当接近0(只需将/trains/rnn.py中的np.random.shuffle(data)取消注释即为乱序)
所以股票是可以根据其历史数据进行预测的。
### 根据历史数据预测开盘的涨幅
以标普500为例子，我们主观地认为vix，shy，tlt很可能有助于标普500开盘价的预测。
由于这是时间序列数据，所以我们用rnn中的gru建模。输入vix，bp，shy，tlt前20个交易日的数据，输出下一个交易日的开盘价涨幅。
在建模的过程中有以下若干个重要细节。
1. 我们取得数据时间跨度长达十几年，十几年前的价格和今天的价格可能有很大的差距。要将股票每日的开、高、低、收的价格都转化成相应的基于上个交易日的收盘价的涨幅。这样做的话既不会损失信息，又能减轻数据随时间的变异程度。
2. 对于输入的数据做标准花会加快模型的收敛，但要注意如果简单地一列一列地做标椎化可能就会损失信息（例如同一天的最高价和最低价的差值可能很重要，但是如果分别对最高价和最低价做标准化，我们就无从得到这个指标）
3. 有些股票可能会分红送股，我们需要消除这些行为对股价数值的影响，所以要根据调整后的收盘价“Adj Close”去调整开盘价、最高价、最低价、收盘价。
分别对一下几种情况建模，然后输出预测值与真实值的相关系数，各50次
1. bp_bp_bp_bp:只加入标普500的历史数据
2. bp_bp_bp_vix:加入标普500和vix
3. bp_bp_bp_shy:加入标普500和shy
4. bp_bp_bp_tlt:加入标普500和tlt
5. bp_bp_shy_tlt:加入标普500、shy和tlt
6. bp_shy_tlt_vix:加入标普500、shy、tlt和vix
其相关系数均值从小到大排列为：
1. 'bp_bp_bp_bp', 0.1250000843182222
2. 'bp_bp_bp_vix', 0.1316010009242311
3. 'bp_bp_bp_tlt', 0.13719981968829242
4. 'bp_bp_shy_tlt', 0.13754427530244764
5. 'bp_shy_tlt_vix', 0.13975763206493108
6. 'bp_bp_bp_shy', 0.1440086437994764

两两做显著水平为0.05的单因素方差分析，显著的为（右边的数字为p值）。
1.  bp_bp_bp_bp bp_bp_bp_tlt 0.02217815639649356
2.  bp_bp_bp_bp bp_bp_bp_shy 0.0001617009624638757
3.  bp_bp_bp_bp bp_bp_shy_tlt 0.010518793155787614
4.  bp_bp_bp_bp bp_shy_tlt_vix 0.0051330645069509575
5.  bp_bp_bp_vix bp_bp_bp_shy 0.01759709617976107
所以可以看出shy、tlt、vix都能提高预测的准确度。其中只加入shy比只加入vix效果好
根据最大似然的思想，我们选择只加标普500和shy的历史数据进入模型中，最终模型预测值与真实值的相关系数的期望为0.144.虽然相关性不高，但是也有一定借鉴意义。
### 根据历史数据预测日振幅
